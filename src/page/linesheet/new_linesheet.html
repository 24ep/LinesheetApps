
<style>

    .dropdown_rc {
        display: none;
        position: absolute;
        background-color: #f9f9f9;
        min-width: 120px;
        box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
        padding: 12px 16px;
        z-index: 1;
    }

    .element.w-100.p-3:hover {
        background: #ececec;

    }


    .ss-main .ss-values .ss-value {
        display: flex;
        user-select: none;
        align-items: center;
        width: fit-content;
        background-color: #dfdfdf;
        border-radius: var(--ss-border-radius);
        animation-name: ss-valueIn;
        animation-duration: var(--ss-animation-timing);
        animation-timing-function: ease-out;
        animation-fill-mode: both;
        margin: 3px;
        padding:3px;
    }
    .ss-main .ss-values .ss-max {
        display: flex;
        user-select: none;
        align-items: center;
        width: fit-content;
        font-size: 12px;
        color: var(--ss-bg-color);
        line-height: 1;
        padding: var(--ss-spacing-s) var(--ss-spacing-m);
        background-color: #dfdfdf;
        border-radius: var(--ss-border-radius);
    }
    .ss-main .ss-values .ss-value .ss-value-text {
        font-size: 12px;
        color: #495057;
        line-height: 1;
        padding: var(--ss-spacing-s) var(--ss-spacing-m);
        font-weight: 500;
    }
    .ss-main .ss-values .ss-value .ss-value-delete {
        display: table;
    }
</style>
<div class="border-bottom pb-2 pt-4 shadow-sm text-white bg-dark">
    <div class="d-flex">
        <div class="p-2 flex-grow-1">
            <div class="container ">
                <div class="row">
                    <div class="col-sm-3" style="inline-size: fit-content;font-size: 40px;">
                    </div>
                    <div class="col-sm-9 p-0">
                        <h6 class=" ps-3">
                            <strong>Create new central linesheet</strong>
                        </h6>
                        <small class=" ps-3">Please fill product information a bit to generate a linesheet break by categories of product</small></div>
                    </div>
                </div>
            </div>
            <!-- <div class="p-2">Search</div> -->
            <div class="p-2 me-3">
                <button type="button" class="btn btn-danger shadow-sm bg-gradient" data-bs-toggle="modal" data-bs-target="#create_new_model">
                    <ion-icon name="bag-add-outline"></ion-icon> Create new linesheet
                </button>
            </div>
        </div>
        <!-- Button trigger modal -->
        <!-- Modal -->
        <div class="modal fade" id="create_new_model" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title text-black" id="staticBackdropLabel" >Create new linesheet</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body ps-5 pe-5">
                        <span class="fw-bold text-black mt-2 mb-2">
                            <ion-icon name="cube-outline"></ion-icon>
                            Product information</span><br>
                            <!-- brand name -->
                            <label class="text-black mb-2 mt-2" for="brand">Brand</label>
                            <input class="form-control form-control-sm" list="brand_list" id="brand" placeholder="Type to search...">
                            <datalist id="brand_list">
                            </datalist>
                            <!-- number of sku -->
                            <label class="text-black mb-2 mt-2" for="brand">Total SKUs</label>
                            <input type="number" min="1" max="5000" class="form-control form-control-sm" id="sku" placeholder="">
                            <!-- store stock -->
                            <div id='stock_source_options'>
                                <p class="placeholder-glow">
                                    <span class="placeholder w-25 opacity-25 bg-secondary"></span>
                                    <span class="placeholder w-75 opacity-25 bg-secondary"></span>
                                </p>
                            </div>

                            <!-- template -->
                            <div id='template_options'>
                                <p class="placeholder-glow">
                                    <span class="placeholder w-25 opacity-25 bg-secondary"></span>
                                    <span class="placeholder w-75 opacity-25 bg-secondary"></span>
                                </p>
                            </div>

                            <hr class="text-secondary">
                            <span class="fw-bold text-black mt-2 mb-2" class="text-black">
                                <ion-icon name="ticket-outline"></ion-icon>
                                Job information</span><br>
                                <!-- launch date -->
                                <label for="launch_date" class="text-black mt-2 mb-2">launch date</label>
                                <input type="date" class="form-control from-control-sm" id="launch_date" placeholder="">
                                <!-- production tpe -->
                                <div id='production_type_options'>
                                    <p class="placeholder-glow">
                                        <span class="placeholder w-25 opacity-25 bg-secondary"></span>
                                        <span class="placeholder w-75 opacity-25 bg-secondary"></span>
                                    </p>
                                </div>



                                <!-- chanel -->
                                <div id='sale_channel_options'>
                                    <p class="placeholder-glow">
                                        <span class="placeholder w-25 opacity-25 bg-secondary"></span>
                                        <span class="placeholder w-75 opacity-25 bg-secondary"></span>
                                    </p>
                                </div>

                                <!-- contact person -->

                                <label for="contact_person" class="text-black mt-2 mb-2" >Contact Person</label>
                                <textarea class="form-control" placeholder="Name , Email , Phone" id="contact_person" style="height: 100px"></textarea>

                                <div class="mt-3 mb-3">
                                    <button type="button" onclick="generate_linesheet()" id="generate_linesheet" class="btn btn-dark btn-sm" style="width: 100%;">Generate linesheet</button>
                                    <div id='generate_status'>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="ms-3 me-3" style="height: -webkit-fill-available;">

                <div class="row h-100" >

                    <div class="col-2 pt-4 border-end p-0">

                        <!-- <div id="dropdown1" class="dropdown dropdown-menu p-0 border-0">
                            <li><a class="dropdown-item" href="#"><ion-icon name="add-outline"></ion-icon> New folder</a></li>
                        </div> -->

                        <div id="folder_list">
                            <!-- Linesheet -->
                        </div>
                    </div>
                    <div class="col-10 ps-0 pe-0">
                        <div id="linesheet_folder">
                        </div>
                    </div>
                </div>
            </div>
            <!-- <script src="dist/bundle.js"></script> -->
            <!-- <script type="module" src="/page/linesheet/js/new_linesheet.js"></script> -->
            <!-- <script src="/page/linesheet/js/new_linesheet.js"></script> -->

            <script>

                fetch('/linesheet-creation')
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Failed to load new_linesheet.js');
                    }
                    return response.text();
                })
                .then(data => {
                    // console.log(data);
                    const jsonData = JSON.parse(data);
                    // Access the properties
                    var templateOptions = jsonData.template_options;
                    var saleChannelOptions = jsonData.sale_channel_options;
                    var productionTypeOptions = jsonData.production_type_options;
                    var stockSourceOptions = jsonData.stock_source_options;

                    document.getElementById('template_options').innerHTML = templateOptions;
                    document.getElementById('sale_channel_options').innerHTML = saleChannelOptions;
                    document.getElementById('production_type_options').innerHTML = productionTypeOptions;
                    document.getElementById('stock_source_options').innerHTML = stockSourceOptions;

                    new TomSelect('#template',{});
                    new TomSelect('#sale_channel',{});
                    new TomSelect('#production_type',{});
                    new TomSelect('#stock_source',{});

                })
                .catch(error => {
                    console.error(error); // Log error message
                    // Optionally, you can handle the error here
                });


                fetch('/get_folder_linesheet_list')
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Failed to load new_linesheet.js');
                    }
                    return response.text();
                })
                .then(data => {
                    document.getElementById('folder_list').innerHTML = data;

                })
                .catch(error => {
                    console.error(error); // Log error message
                    // Optionally, you can handle the error here
                });


            function generate_linesheet(){
                Notiflix.Loading.standard('Generating ...');

                brand = document.getElementById("brand").value
                template = [...document.querySelectorAll("#template option:checked")].map(option => option.value).join(',');
                sku = document.getElementById("sku").value
                launch_date = document.getElementById("launch_date").value
                stock_source = [...document.querySelectorAll("#stock_source option:checked")].map(option => option.value).join(',');
                sale_channel = [...document.querySelectorAll("#sale_channel option:checked")].map(option => option.value).join(',');
                production_type = document.getElementById("production_type").value
                contact_person=document.getElementById("contact_person").value

                const arguments = {
                    brand: brand,
                    template: template,
                    sku: sku,
                    launch_date: launch_date,
                    stock_source: stock_source,
                    sale_channel: sale_channel,
                    production_type: production_type,
                    contact_person: contact_person,
                };

                const queryString = Object.keys(arguments)
                .map(key => encodeURIComponent(key) + '=' + encodeURIComponent(arguments[key]))
                .join('&');

                const url = '/generate-new-linesheet?' + queryString;
                fetch(url)
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Failed to load new_linesheet.js');
                    }
                    return response.text();
                })
                .then(data => {


                })
                .catch(error => {
                    console.error(error); // Log error message
                    // Optionally, you can handle the error here
                });


            }


            </script>


